きょうはブラウザがWebサーバーに接続するまでの仕組みの中で "TCP/IP" について説明していきます。

まずは前回のおさらいです。Webの基本的な流れは
1. ブラウザにURLを指定する
2. URLからWebサーバーの名前が決まる
3. DNSサーバーに問い合わせてIPアドレスに変換する（名前解決）
4. ブラウザはIPアドレスのサーバーにhttpという通信方法で接続する
でした。
ここで、サーバー名をDNSという仕組みでIPアドレスに変換する「名前解決」がポイントでしたね。

今回はこのIPアドレスを使うと、どうしてサーバーまでたどり着けるのか、について解説します。

IPアドレスは 192.168.11.10 のように4つの数字で表現します。
この4つの数字はそれぞれ0〜255までの値をとります。つまり 0.0.0.0 〜 255.255.255.255 までです。
255というのは2進数8桁で表すことができる最大の数字です。2の8乗 = 256種類の数を扱うことができ、数字の0があるので最大の数は255になります。

2進数8桁の数字を4つ組み合わせるので、IPアドレス全体だと
2 ^ 8 * 2 ^ 8 * 2 ^ 8 * 2 ^ 8
256 * 256 * 256 * 256
つまり 4,294,967,296 個のアドレスを表現できるわけです。42億個以上です。

ここでは話を単純にするためにこのIPアドレス1つ1つが、世界中のコンピューター1台1台に割り当てられていると思ってください。
そのためIPアドレスがわかれば、そのサーバーにたどり着くことができるわけです。

さて、ここまでIPアドレスとコンピューターの関係について説明しました。
ではIPアドレスからどうやってコンピューターにたどり着くかについて掘り下げてみたいと思います。

例えば先ほど例にだした 192.168.11.10 というアドレスは、さらに "ネットワーク部" と "ホスト部" に分かれます。
例えば 192.168.11 までがネットワーク部で、最後の10がホスト部というようにです。

ここで同じネットワークのコンピューターに対しては直接通信することができます。
192.168.11.10 A と 192.168.11.11 B というそれぞれIPアドレスが割り当てられたコンピューターがあり、2台のコンピューターが 192.168.11 という同じネットワークにある場合、 A"10" は B"11" に直接データを渡すことができるわけです。

（イメージ：A"10" が B"11" を探す）
（イメージ：B"11" が私ですと返事する）
（イメージ：A"10" が B"11" にデータを渡す）

では次は、2台のコンピューターが異なるネットワークにいる場合について説明します。

（イメージ：A "192.168.11.10" から C "10.0.0.10" に通信しようとする）

2台のコンピューターは異なるネットワークにあるので、A のコンピューターはCがどこにいるかわかりません。

（イメージ：A は C がどこにいるかわからない）

そのため "ルーター" と呼ばれるネットワーク装置にデータを渡し、代わりにCに届けてもらいます。
ルーターはネットワークの間を繋ぐ装置です。

（イメージ：ルーター 192.168.10.1 と 10.0.0.1 という2の手（IPアドレス）を持つ）

たとえば図のルーターは 192.168.10.1 と 10.0.0.1 という2つのIPアドレスを持ちます。
つまり 192.168.10 と 10.0.0 という2つのネットワークにいるわけです。

AはC宛てのデータをルーターに渡します。ここでAにはもし異なるネットワークにデータを送る場合は 192.168.10.1 のルーターに渡してね、とあらかじめ設定してあるためです。これを "デフォルトゲートウェイ" といいます。

データを受け取ったルーターは宛先を確認します。10.0.0.10がある 10.0.0 というネットワークにはルーター自身も参加しているので、ルーターはBに直接データを渡すことができるわけです。

ここまで理解できましたか？

もしデータを渡されたルーターも、自分がその宛先のネットワークにいない場合は、次に指示された別のルーターに届けてもらいます。そのルーターも分からなければ次に、さらにその次のルーターも、、、というようにデータは運ばれていき、最終的には目的のコンピューター（Webサーバー）にデータを届けることができます。

